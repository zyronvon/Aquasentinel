<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - AquaSentinel</title>
    <meta name="description" content="AquaSentinel dashboard showing CNN model results for microplastics detection.">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Navigation -->
    <div class="nav-container">
        <nav>
            <a href="index.html" class="logo">AquaSentinel</a>
            <ul class="nav-links" id="navLinks">
                <li><a href="index.html">Landing</a></li>
                <li><a href="dashboard.html" class="active">Dashboard</a></li>
                <li><a href="profile.html">Profile</a></li>
                <li><a href="about.html">About Us</a></li>
                <li><a href="#" onclick="signOut()" class="btn-secondary">Sign Out</a></li>
            </ul>
            <button class="mobile-menu-btn" onclick="toggleMobileMenu()">‚ò∞</button>
        </nav>
    </div>

    <!-- Main Content -->
    <main>
        <div class="container fade-in">
            <div class="flex justify-between align-center mb-2">
                <h1 style="color: #00bcd4; font-size: 2.5rem;">Model Results Dashboard</h1>
                <button id="exportBtn" class="btn" onclick="exportCSV()">üì• Export Data</button>
            </div>

            <!-- Dashboard Grid -->
            <div class="dashboard-grid">
                <!-- CSV Data Card -->
                <div class="data-card">
                    <h3>üìä Prediction Results</h3>
                    <div id="csvLoading" class="loading">Loading prediction data...</div>
                    <div id="csvError" class="error hidden">Failed to load prediction data. Please try again.</div>
                    <div class="table-container" id="csvTableContainer" style="display: none;">
                        <table id="csvTable">
                            <thead id="csvTableHead"></thead>
                            <tbody id="csvTableBody"></tbody>
                        </table>
                    </div>
                </div>

                <!-- Confidence Histogram -->
                <div class="data-card">
                    <h3>üìà Confidence Distribution</h3>
                    <div id="histogramLoading" class="loading">Loading confidence histogram...</div>
                    <div id="histogramError" class="error hidden">Failed to load confidence histogram.</div>
                    <div class="chart-container" id="histogramContainer" style="display: none;">
                        <img id="histogramImg" alt="Confidence Histogram" onclick="openModal(this)">
                    </div>
                </div>

                <!-- Misclassified Samples -->
                <div class="data-card">
                    <h3>‚ùå Misclassified Samples</h3>
                    <div id="misclassifiedLoading" class="loading">Loading misclassified samples...</div>
                    <div id="misclassifiedError" class="error hidden">Failed to load misclassified samples.</div>
                    <div class="chart-container" id="misclassifiedContainer" style="display: none;">
                        <img id="misclassifiedImg" alt="Misclassified Samples" onclick="openModal(this)">
                    </div>
                </div>

                <!-- Sample Predictions -->
                <div class="data-card">
                    <h3>üîç Sample Predictions</h3>
                    <div id="samplesLoading" class="loading">Loading sample predictions...</div>
                    <div id="samplesError" class="error hidden">Failed to load sample predictions.</div>
                    <div class="chart-container" id="samplesContainer" style="display: none;">
                        <img id="samplesImg" alt="Sample Predictions" onclick="openModal(this)">
                    </div>
                </div>
            </div>

            <!-- Statistics Summary -->
            <div class="card mt-2">
                <h3>üìã Summary Statistics</h3>
                <div id="statsContainer" class="flex justify-between gap-1" style="flex-wrap: wrap;">
                    <div class="stat-item" style="background: rgba(0, 188, 212, 0.1); padding: 1rem; border-radius: 8px; text-align: center; min-width: 150px;">
                        <div style="font-size: 2rem; color: #00bcd4; font-weight: 700;" id="totalSamples">-</div>
                        <div style="color: #b0c4de;">Total Samples</div>
                    </div>
                    <div class="stat-item" style="background: rgba(76, 175, 80, 0.1); padding: 1rem; border-radius: 8px; text-align: center; min-width: 150px;">
                        <div style="font-size: 2rem; color: #4caf50; font-weight: 700;" id="avgConfidence">-</div>
                        <div style="color: #b0c4de;">Avg Confidence</div>
                    </div>
                    <div class="stat-item" style="background: rgba(255, 152, 0, 0.1); padding: 1rem; border-radius: 8px; text-align: center; min-width: 150px;">
                        <div style="font-size: 2rem; color: #ff9800; font-weight: 700;" id="highConfSamples">-</div>
                        <div style="color: #b0c4de;">High Confidence (>80%)</div>
                    </div>
                    <div class="stat-item" style="background: rgba(244, 67, 54, 0.1); padding: 1rem; border-radius: 8px; text-align: center; min-width: 150px;">
                        <div style="font-size: 2rem; color: #f44336; font-weight: 700;" id="lowConfSamples">-</div>
                        <div style="color: #b0c4de;">Low Confidence (<50%)</div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Image Modal -->
    <div id="imageModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal()">&times;</span>
            <img id="modalImage" alt="Enlarged view">
        </div>
    </div>

    <script src="script.js"></script>
    <script>
        // Load dashboard data when page loads
        document.addEventListener('DOMContentLoaded', function() {
            loadDashboardData();
        });
    </script>
</body>
</html>
